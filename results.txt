Source: https://github.com/qubvel/segmentation_models.pytorch
supported encoders: ['resnet18', 'resnet34', 'resnet50', 'resnet101', 'resnet152', 'resnext50_32x4d', 'resnext101_32x4d', 'resnext101_32x8d', 'resnext101_32x16d', 'resnext101_32x32d', 
'resnext101_32x48d', 'dpn68', 'dpn68b', 'dpn92', 'dpn98', 'dpn107', 'dpn131', 'vgg11', 'vgg11_bn', 'vgg13', 'vgg13_bn', 'vgg16', 'vgg16_bn', 'vgg19', 'vgg19_bn', 'senet154', 
'se_resnet50', 'se_resnet101', 'se_resnet152', 'se_resnext50_32x4d', 'se_resnext101_32x4d', 'densenet121', 'densenet169', 'densenet201', 'densenet161', 'inceptionresnetv2', 
'inceptionv4', 'efficientnet-b0', 'efficientnet-b1', 'efficientnet-b2', 'efficientnet-b3', 'efficientnet-b4', 'efficientnet-b5', 'efficientnet-b6', 'efficientnet-b7', 
'mobilenet_v2', 'xception', 'timm-efficientnet-b0', 'timm-efficientnet-b1', 'timm-efficientnet-b2', 'timm-efficientnet-b3', 'timm-efficientnet-b4', 'timm-efficientnet-b5', 
'timm-efficientnet-b6', 'timm-efficientnet-b7', 'timm-efficientnet-b8', 'timm-efficientnet-l2', 'timm-tf_efficientnet_lite0', 'timm-tf_efficientnet_lite1', 'timm-tf_efficientnet_lite2', 
'timm-tf_efficientnet_lite3', 'timm-tf_efficientnet_lite4', 'timm-resnest14d', 'timm-resnest26d', 'timm-resnest50d', 'timm-resnest101e', 'timm-resnest200e', 'timm-resnest269e', 'timm-resnest50d_4s2x40d', 
'timm-resnest50d_1s4x24d', 'timm-res2net50_26w_4s', 'timm-res2net101_26w_4s', 'timm-res2net50_26w_6s', 'timm-res2net50_26w_8s', 'timm-res2net50_48w_2s', 'timm-res2net50_14w_8s', 'timm-res2next50', 
'timm-regnetx_002', 'timm-regnetx_004', 'timm-regnetx_006', 'timm-regnetx_008', 'timm-regnetx_016', 'timm-regnetx_032', 'timm-regnetx_040', 'timm-regnetx_064', 'timm-regnetx_080', 'timm-regnetx_120',
 'timm-regnetx_160', 'timm-regnetx_320', 'timm-regnety_002', 'timm-regnety_004', 'timm-regnety_006', 'timm-regnety_008', 'timm-regnety_016', 'timm-regnety_032', 'timm-regnety_040', 'timm-regnety_064', 
 'timm-regnety_080', 'timm-regnety_120', 'timm-regnety_160', 'timm-regnety_320', 'timm-skresnet18', 'timm-skresnet34', 'timm-skresnext50_32x4d', 'timm-mobilenetv3_large_075', 'timm-mobilenetv3_large_100', 
 'timm-mobilenetv3_large_minimal_100', 'timm-mobilenetv3_small_075', 'timm-mobilenetv3_small_100', 'timm-mobilenetv3_small_minimal_100', 'timm-gernet_s', 'timm-gernet_m', 'timm-gernet_l']

#---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------


timm-mobilenetv3_small_075

==============================================================================================================
Layer (type:depth-idx)                                       Output Shape              Param #
==============================================================================================================
SwinUnet                                                     [16, 2, 512, 512]         --
├─SwinTransformerSys: 1-1                                    [16, 2, 512, 512]         7,304,416
│    └─MobileNetV3Encoder: 2-1                               [16, 3, 512, 512]         --
│    │    └─MobileNetV3Features: 3-1                         --                        573,480
│    └─PatchEmbed: 2-2                                       [16, 16384, 96]           --
│    │    └─Conv2d: 3-2                                      [16, 96, 128, 128]        4,704
│    │    └─LayerNorm: 3-3                                   [16, 16384, 96]           192
│    └─Dropout: 2-3                                          [16, 16384, 96]           --
│    └─ModuleList: 2-4                                       --                        --
│    │    └─BasicLayer: 3-4                                  [16, 4096, 192]           303,942
│    │    └─BasicLayer: 3-5                                  [16, 1024, 384]           1,197,708
│    │    └─BasicLayer: 3-6                                  [16, 256, 768]            4,754,712
│    │    └─BasicLayer: 3-7                                  [16, 256, 768]            14,221,872
│    └─LayerNorm: 2-5                                        [16, 256, 768]            1,536
│    └─ModuleList: 2-6                                       --                        --
│    │    └─SCF_block: 3-8                                   [16, 256, 16, 16]         6,464,911
│    │    └─SCF_block: 3-9                                   [16, 128, 32, 32]         1,556,828
│    │    └─SCF_block: 3-10                                  [16, 64, 64, 64]          391,429
│    │    └─SCF_block: 3-11                                  [16, 32, 128, 128]        99,075
│    └─UnetDecoder: 2-7                                      [16, 32, 256, 256]        --
│    │    └─ModuleList: 3-12                                 --                        2,149,248
│    └─SegmentationHead: 2-8                                 [16, 2, 512, 512]         --
│    │    └─Conv2d: 3-13                                     [16, 2, 256, 256]         578
│    │    └─UpsamplingBilinear2d: 3-14                       [16, 2, 512, 512]         --
│    │    └─Activation: 3-15                                 [16, 2, 512, 512]         --
==============================================================================================================
Total params: 39,024,631
Trainable params: 39,024,631
Non-trainable params: 0
Total mult-adds (G): 151.14
==============================================================================================================
Input size (MB): 50.33
Forward/backward pass size (MB): 14877.24
Params size (MB): 101.44
Estimated Total Size (MB): 15029.01
==============================================================================================================

results:
epoch0.0  _train_loss0.051889050751924515  _val_loss0.07109692692756653 _epoch_acc0.1707627775031142 _val_iou0.029974981024861336
epoch1.0  _train_loss0.04205827166636785  _val_loss0.07159780263900757 _epoch_acc0.3432534833749135 _val_iou0.03897831509821117
epoch2.0  _train_loss0.03751213724414507  _val_loss0.07136655449867249 _epoch_acc0.5164009070334336 _val_iou0.06974829258397222
epoch3.0  _train_loss0.03381307050585747  _val_loss0.07032233476638794 _epoch_acc0.6652825453008214 _val_iou0.19566209139302373
epoch4.0  _train_loss0.033345334231853485  _val_loss0.06958863139152527 _epoch_acc0.6593349981897821 _val_iou0.27719619022682307

#---------------------------------------------------------------------------------------------------------------------------------------------------

timm-regnetx_002

==============================================================================================================
Layer (type:depth-idx)                                       Output Shape              Param #
==============================================================================================================
SwinUnet                                                     [16, 2, 512, 512]         --
├─SwinTransformerSys: 1-1                                    [16, 2, 512, 512]         7,304,672
│    └─RegNetEncoder: 2-1                                    [16, 3, 512, 512]         --
│    │    └─ConvBnAct: 3-1                                   [16, 32, 256, 256]        928
│    │    └─RegStage: 3-2                                    [16, 24, 128, 128]        4,032
│    │    └─RegStage: 3-3                                    [16, 56, 64, 64]          10,304
│    │    └─RegStage: 3-4                                    [16, 152, 32, 32]         226,480
│    │    └─RegStage: 3-5                                    [16, 368, 16, 16]         2,074,048
│    └─PatchEmbed: 2-2                                       [16, 16384, 96]           --
│    │    └─Conv2d: 3-6                                      [16, 96, 128, 128]        4,704
│    │    └─LayerNorm: 3-7                                   [16, 16384, 96]           192
│    └─Dropout: 2-3                                          [16, 16384, 96]           --
│    └─ModuleList: 2-4                                       --                        --
│    │    └─BasicLayer: 3-8                                  [16, 4096, 192]           303,942
│    │    └─BasicLayer: 3-9                                  [16, 1024, 384]           1,197,708
│    │    └─BasicLayer: 3-10                                 [16, 256, 768]            4,754,712
│    │    └─BasicLayer: 3-11                                 [16, 256, 768]            14,221,872
│    └─LayerNorm: 2-5                                        [16, 256, 768]            1,536
│    └─ModuleList: 2-6                                       --                        --
│    │    └─SCF_block: 3-12                                  [16, 256, 16, 16]         6,417,283
│    │    └─SCF_block: 3-13                                  [16, 128, 32, 32]         1,595,713
│    │    └─SCF_block: 3-14                                  [16, 64, 64, 64]          396,971
│    │    └─SCF_block: 3-15                                  [16, 32, 128, 128]        99,763
│    └─UnetDecoder: 2-7                                      [16, 32, 256, 256]        --
│    │    └─ModuleList: 3-16                                 --                        2,149,248
│    └─SegmentationHead: 2-8                                 [16, 2, 512, 512]         --
│    │    └─Conv2d: 3-17                                     [16, 2, 256, 256]         578
│    │    └─UpsamplingBilinear2d: 3-18                       [16, 2, 512, 512]         --
│    │    └─Activation: 3-19                                 [16, 2, 512, 512]         --
==============================================================================================================
Total params: 40,764,686
Trainable params: 40,764,686
Non-trainable params: 0
Total mult-adds (G): 165.20
==============================================================================================================
Input size (MB): 50.33
Forward/backward pass size (MB): 14633.70
Params size (MB): 108.32
Estimated Total Size (MB): 14792.34
==============================================================================================================

results:

epoch0.0  _train_loss0.04657881831129392  _val_loss0.07250419855117798 _epoch_acc0.2863244175678119 _val_iou0.026381301881901197
epoch1.0  _train_loss0.03577121595541636  _val_loss0.07308504581451417 _epoch_acc0.534067216484497 _val_iou0.026875752476917113
epoch2.0  _train_loss0.030711997921268146  _val_loss0.07209599614143372 _epoch_acc0.6918702479451895 _val_iou0.028362016403116287
epoch3.0  _train_loss0.026977103824416798  _val_loss0.07027113437652588 _epoch_acc0.7818876982976993 _val_iou0.17164868540130557
epoch4.0  _train_loss0.02762109910448392  _val_loss0.06783460378646851 _epoch_acc0.7386410368653742 _val_iou0.397834231890738

#---------------------------------------------------------------------------------------------------------------------------------------------------

timm-mobilenetv3_small_minimal_100

Summary about the model: 

==============================================================================================================
Layer (type:depth-idx)                                       Output Shape              Param #
==============================================================================================================
SwinUnet                                                     [16, 2, 512, 512]         --
├─SwinTransformerSys: 1-1                                    [16, 2, 512, 512]         7,342,304
│    └─MobileNetV3Encoder: 2-1                               [16, 3, 512, 512]         --
│    │    └─MobileNetV3Features: 3-1                         --                        428,888
│    └─PatchEmbed: 2-2                                       [16, 16384, 96]           --
│    │    └─Conv2d: 3-2                                      [16, 96, 128, 128]        4,704
│    │    └─LayerNorm: 3-3                                   [16, 16384, 96]           192
│    └─Dropout: 2-3                                          [16, 16384, 96]           --
│    └─ModuleList: 2-4                                       --                        --
│    │    └─BasicLayer: 3-4                                  [16, 4096, 192]           303,942
│    │    └─BasicLayer: 3-5                                  [16, 1024, 384]           1,197,708
│    │    └─BasicLayer: 3-6                                  [16, 256, 768]            4,754,712
│    │    └─BasicLayer: 3-7                                  [16, 256, 768]            14,221,872
│    └─LayerNorm: 2-5                                        [16, 256, 768]            1,536
│    └─ModuleList: 2-6                                       --                        --
│    │    └─SCF_block: 3-8                                   [16, 256, 16, 16]         6,575,818
│    │    └─SCF_block: 3-9                                   [16, 128, 32, 32]         1,559,551
│    │    └─SCF_block: 3-10                                  [16, 64, 64, 64]          391,429
│    │    └─SCF_block: 3-11                                  [16, 32, 128, 128]        99,075
│    └─UnetDecoder: 2-7                                      [16, 32, 256, 256]        --
│    │    └─ModuleList: 3-12                                 --                        2,149,248
│    └─SegmentationHead: 2-8                                 [16, 2, 512, 512]         --
│    │    └─Conv2d: 3-13                                     [16, 2, 256, 256]         578
│    │    └─UpsamplingBilinear2d: 3-14                       [16, 2, 512, 512]         --
│    │    └─Activation: 3-15                                 [16, 2, 512, 512]         --
==============================================================================================================
Total params: 39,031,557
Trainable params: 39,031,557
Non-trainable params: 0
Total mult-adds (G): 152.31
==============================================================================================================
Input size (MB): 50.33
Forward/backward pass size (MB): 15036.37
Params size (MB): 101.32
Estimated Total Size (MB): 15188.02
==============================================================================================================
Charged config file

Summary about the model: 

==============================================================================================================
Layer (type:depth-idx)                                       Output Shape              Param #
==============================================================================================================
SwinUnet                                                     [16, 2, 512, 512]         --
├─SwinTransformerSys: 1-1                                    [16, 2, 512, 512]         7,342,304
│    └─MobileNetV3Encoder: 2-1                               [16, 3, 512, 512]         --
│    │    └─MobileNetV3Features: 3-1                         --                        428,888
│    └─PatchEmbed: 2-2                                       [16, 16384, 96]           --
│    │    └─Conv2d: 3-2                                      [16, 96, 128, 128]        4,704
│    │    └─LayerNorm: 3-3                                   [16, 16384, 96]           192
│    └─Dropout: 2-3                                          [16, 16384, 96]           --
│    └─ModuleList: 2-4                                       --                        --
│    │    └─BasicLayer: 3-4                                  [16, 4096, 192]           303,942
│    │    └─BasicLayer: 3-5                                  [16, 1024, 384]           1,197,708
│    │    └─BasicLayer: 3-6                                  [16, 256, 768]            4,754,712
│    │    └─BasicLayer: 3-7                                  [16, 256, 768]            14,221,872
│    └─LayerNorm: 2-5                                        [16, 256, 768]            1,536
│    └─ModuleList: 2-6                                       --                        --
│    │    └─SCF_block: 3-8                                   [16, 256, 16, 16]         6,575,818
│    │    └─SCF_block: 3-9                                   [16, 128, 32, 32]         1,559,551
│    │    └─SCF_block: 3-10                                  [16, 64, 64, 64]          391,429
│    │    └─SCF_block: 3-11                                  [16, 32, 128, 128]        99,075
│    └─UnetDecoder: 2-7                                      [16, 32, 256, 256]        --
│    │    └─ModuleList: 3-12                                 --                        2,149,248
│    └─SegmentationHead: 2-8                                 [16, 2, 512, 512]         --
│    │    └─Conv2d: 3-13                                     [16, 2, 256, 256]         578
│    │    └─UpsamplingBilinear2d: 3-14                       [16, 2, 512, 512]         --
│    │    └─Activation: 3-15                                 [16, 2, 512, 512]         --
==============================================================================================================
Total params: 39,031,557
Trainable params: 39,031,557
Non-trainable params: 0
Total mult-adds (G): 152.31
==============================================================================================================
Input size (MB): 50.33
Forward/backward pass size (MB): 15036.37
Params size (MB): 101.32
Estimated Total Size (MB): 15188.02
==============================================================================================================

epoch0.0  _train_loss0.07433448607722919  _val_loss0.13508915305137634 _epoch_acc0.5314911359649462 _val_iou0.5803166478872299
epoch1.0  _train_loss0.05716484350462755  _val_loss0.12141635417938232 _epoch_acc0.769343042780747 _val_iou0.6741003761999309
epoch2.0  _train_loss0.04826310152808825  _val_loss0.10647235810756683 _epoch_acc0.8031009534994761 _val_iou0.6515594320371747
epoch3.0  _train_loss0.04333442263305187  _val_loss0.10066405236721039 _epoch_acc0.8146292823368384 _val_iou0.5901503963395953
epoch4.0  _train_loss0.042720491687456764  _val_loss0.10064762234687805 _epoch_acc0.80630921265841 _val_iou0.565612213453278

['lr', '0.0001']
['batch', 8]
['seed', 8]
['best_val_acc', '0.6741003761999309']
['warm_epoch', 0]
['end_epoch', 5]

#---------------------------------------------------------------------------------------------------------------------------------------------

resnet18

==============================================================================================================
Layer (type:depth-idx)                                       Output Shape              Param #
==============================================================================================================
SwinUnet                                                     [16, 2, 512, 512]         --
├─SwinTransformerSys: 1-1                                    [16, 2, 512, 512]         7,360,736
│    └─ResNetEncoder: 2-1                                    [16, 3, 512, 512]         --
│    │    └─Conv2d: 3-1                                      [16, 64, 256, 256]        9,408
│    │    └─BatchNorm2d: 3-2                                 [16, 64, 256, 256]        128
│    │    └─ReLU: 3-3                                        [16, 64, 256, 256]        --
│    │    └─MaxPool2d: 3-4                                   [16, 64, 128, 128]        --
│    │    └─Sequential: 3-5                                  [16, 64, 128, 128]        147,968
│    │    └─Sequential: 3-6                                  [16, 128, 64, 64]         525,568
│    │    └─Sequential: 3-7                                  [16, 256, 32, 32]         2,099,712
│    │    └─Sequential: 3-8                                  [16, 512, 16, 16]         8,393,728
│    └─PatchEmbed: 2-2                                       [16, 16384, 96]           --
│    │    └─Conv2d: 3-9                                      [16, 96, 128, 128]        4,704
│    │    └─LayerNorm: 3-10                                  [16, 16384, 96]           192
│    └─Dropout: 2-3                                          [16, 16384, 96]           --
│    └─ModuleList: 2-4                                       --                        --
│    │    └─BasicLayer: 3-11                                 [16, 4096, 192]           303,942
│    │    └─BasicLayer: 3-12                                 [16, 1024, 384]           1,197,708
│    │    └─BasicLayer: 3-13                                 [16, 256, 768]            4,754,712
│    │    └─BasicLayer: 3-14                                 [16, 256, 768]            14,221,872
│    └─LayerNorm: 2-5                                        [16, 256, 768]            1,536
│    └─ModuleList: 2-6                                       --                        --
│    │    └─SCF_block: 3-15                                  [16, 256, 16, 16]         6,525,886
│    │    └─SCF_block: 3-16                                  [16, 128, 32, 32]         1,634,886
│    │    └─SCF_block: 3-17                                  [16, 64, 64, 64]          410,506
│    │    └─SCF_block: 3-18                                  [16, 32, 128, 128]        103,596
│    └─UnetDecoder: 2-7                                      [16, 32, 256, 256]        --
│    │    └─ModuleList: 3-19                                 --                        2,149,248
│    └─SegmentationHead: 2-8                                 [16, 2, 512, 512]         --
│    │    └─Conv2d: 3-20                                     [16, 2, 256, 256]         578
│    │    └─UpsamplingBilinear2d: 3-21                       [16, 2, 512, 512]         --
│    │    └─Activation: 3-22                                 [16, 2, 512, 512]         --
==============================================================================================================
Total params: 49,846,614
Trainable params: 49,846,614
Non-trainable params: 0
Total mult-adds (G): 302.74
==============================================================================================================
Input size (MB): 50.33
Forward/backward pass size (MB): 16649.16
Params size (MB): 144.50
Estimated Total Size (MB): 16843.99
==============================================================================================================

epoch0.0  _train_loss0.06799059733748436  _val_loss0.12987954020500184 _epoch_acc0.5413017949322239 _val_iou0.4737466574196785
epoch1.0  _train_loss0.048374619955817856  _val_loss0.11698423027992248 _epoch_acc0.7389677238340179 _val_iou0.7450088844634593
epoch2.0  _train_loss0.03729015216231346  _val_loss0.10015721917152405 _epoch_acc0.8093186006881297 _val_iou0.6234423478599638
epoch3.0  _train_loss0.035374690778553486  _val_loss0.08321294784545899 _epoch_acc0.8179621190453569 _val_iou0.636400478426367
epoch4.0  _train_loss0.03397273955245813  _val_loss0.07826533913612366 _epoch_acc0.804417837333555 _val_iou0.6247873385436833

['lr', '0.0001']
['batch', 8]
['seed', 8]
['best_val_acc', '0.7450088844634593']
['warm_epoch', 0]
['end_epoch', 5]

#---------------------------------------------------------------------------------------------------------------------------------------------

resnet34

==============================================================================================================
Layer (type:depth-idx)                                       Output Shape              Param #
==============================================================================================================
SwinUnet                                                     [16, 2, 512, 512]         --
├─SwinTransformerSys: 1-1                                    [16, 2, 512, 512]         7,360,736
│    └─ResNetEncoder: 2-1                                    [16, 3, 512, 512]         --
│    │    └─Conv2d: 3-1                                      [16, 64, 256, 256]        9,408
│    │    └─BatchNorm2d: 3-2                                 [16, 64, 256, 256]        128
│    │    └─ReLU: 3-3                                        [16, 64, 256, 256]        --
│    │    └─MaxPool2d: 3-4                                   [16, 64, 128, 128]        --
│    │    └─Sequential: 3-5                                  [16, 64, 128, 128]        221,952
│    │    └─Sequential: 3-6                                  [16, 128, 64, 64]         1,116,416
│    │    └─Sequential: 3-7                                  [16, 256, 32, 32]         6,822,400
│    │    └─Sequential: 3-8                                  [16, 512, 16, 16]         13,114,368
│    └─PatchEmbed: 2-2                                       [16, 16384, 96]           --
│    │    └─Conv2d: 3-9                                      [16, 96, 128, 128]        4,704
│    │    └─LayerNorm: 3-10                                  [16, 16384, 96]           192
│    └─Dropout: 2-3                                          [16, 16384, 96]           --
│    └─ModuleList: 2-4                                       --                        --
│    │    └─BasicLayer: 3-11                                 [16, 4096, 192]           303,942
│    │    └─BasicLayer: 3-12                                 [16, 1024, 384]           1,197,708
│    │    └─BasicLayer: 3-13                                 [16, 256, 768]            4,754,712
│    │    └─BasicLayer: 3-14                                 [16, 256, 768]            14,221,872
│    └─LayerNorm: 2-5                                        [16, 256, 768]            1,536
│    └─ModuleList: 2-6                                       --                        --
│    │    └─SCF_block: 3-15                                  [16, 256, 16, 16]         6,525,886
│    │    └─SCF_block: 3-16                                  [16, 128, 32, 32]         1,634,886
│    │    └─SCF_block: 3-17                                  [16, 64, 64, 64]          410,506
│    │    └─SCF_block: 3-18                                  [16, 32, 128, 128]        103,596
│    └─UnetDecoder: 2-7                                      [16, 32, 256, 256]        --
│    │    └─ModuleList: 3-19                                 --                        2,149,248
│    └─SegmentationHead: 2-8                                 [16, 2, 512, 512]         --
│    │    └─Conv2d: 3-20                                     [16, 2, 256, 256]         578
│    │    └─UpsamplingBilinear2d: 3-21                       [16, 2, 512, 512]         --
│    │    └─Activation: 3-22                                 [16, 2, 512, 512]         --
==============================================================================================================
Total params: 59,954,774
Trainable params: 59,954,774
Non-trainable params: 0
Total mult-adds (G): 457.36
==============================================================================================================
Input size (MB): 50.33
Forward/backward pass size (MB): 18326.88
Params size (MB): 184.94
Estimated Total Size (MB): 18562.15
==============================================================================================================

epoch0.0  _train_loss0.06975554426511128  _val_loss0.13605450391769408 _epoch_acc0.574785524290443 _val_iou0.49353110142777595
epoch1.0  _train_loss0.050799437488118805  _val_loss0.11838634014129638 _epoch_acc0.7667645638187727 _val_iou0.5373651955963044
epoch2.0  _train_loss0.042279922092954315  _val_loss0.09659385085105895 _epoch_acc0.7934134341776371 _val_iou0.7412366615608335
epoch3.0  _train_loss0.03740507426361243  _val_loss0.08439714908599853 _epoch_acc0.8188512967899442 _val_iou0.6900789737701416
epoch4.0  _train_loss0.03573672038813432  _val_loss0.0799105405807495 _epoch_acc0.8219285539040962 _val_iou0.6516774906776845

['lr', '0.0001']
['batch', 8]
['seed', 8]
['best_val_acc', '0.7412366615608335']
['warm_epoch', 0]
['end_epoch', 5]

#---------------------------------------------------------------------------------------------------------------------------------------------

resnet50

==============================================================================================================
Layer (type:depth-idx)                                       Output Shape              Param #
==============================================================================================================
SwinUnet                                                     [16, 2, 512, 512]         --
├─SwinTransformerSys: 1-1                                    [16, 2, 512, 512]         7,882,976
│    └─ResNetEncoder: 2-1                                    [16, 3, 512, 512]         --
│    │    └─Conv2d: 3-1                                      [16, 64, 256, 256]        9,408
│    │    └─BatchNorm2d: 3-2                                 [16, 64, 256, 256]        128
│    │    └─ReLU: 3-3                                        [16, 64, 256, 256]        --
│    │    └─MaxPool2d: 3-4                                   [16, 64, 128, 128]        --
│    │    └─Sequential: 3-5                                  [16, 256, 128, 128]       215,808
│    │    └─Sequential: 3-6                                  [16, 512, 64, 64]         1,219,584
│    │    └─Sequential: 3-7                                  [16, 1024, 32, 32]        7,098,368
│    │    └─Sequential: 3-8                                  [16, 2048, 16, 16]        14,964,736
│    └─PatchEmbed: 2-2                                       [16, 16384, 96]           --
│    │    └─Conv2d: 3-9                                      [16, 96, 128, 128]        4,704
│    │    └─LayerNorm: 3-10                                  [16, 16384, 96]           192
│    └─Dropout: 2-3                                          [16, 16384, 96]           --
│    └─ModuleList: 2-4                                       --                        --
│    │    └─BasicLayer: 3-11                                 [16, 4096, 192]           303,942
│    │    └─BasicLayer: 3-12                                 [16, 1024, 384]           1,197,708
│    │    └─BasicLayer: 3-13                                 [16, 256, 768]            4,754,712
│    │    └─BasicLayer: 3-14                                 [16, 256, 768]            14,221,872
│    └─LayerNorm: 2-5                                        [16, 256, 768]            1,536
│    └─ModuleList: 2-6                                       --                        --
│    │    └─SCF_block: 3-15                                  [16, 256, 16, 16]         8,006,878
│    │    └─SCF_block: 3-16                                  [16, 128, 32, 32]         2,006,742
│    │    └─SCF_block: 3-17                                  [16, 64, 64, 64]          504,274
│    │    └─SCF_block: 3-18                                  [16, 32, 128, 128]        127,440
│    └─UnetDecoder: 2-7                                      [16, 32, 256, 256]        --
│    │    └─ModuleList: 3-19                                 --                        2,149,248
│    └─SegmentationHead: 2-8                                 [16, 2, 512, 512]         --
│    │    └─Conv2d: 3-20                                     [16, 2, 256, 256]         578
│    │    └─UpsamplingBilinear2d: 3-21                       [16, 2, 512, 512]         --
│    │    └─Activation: 3-22                                 [16, 2, 512, 512]         --
==============================================================================================================
Total params: 64,670,834
Trainable params: 64,670,834
Non-trainable params: 0
Total mult-adds (G): 509.11
==============================================================================================================
Input size (MB): 50.33
Forward/backward pass size (MB): 28947.64
Params size (MB): 201.71
Estimated Total Size (MB): 29199.68
==============================================================================================================

epoch0.0  _train_loss0.07073850867648919  _val_loss0.12670151591300965 _epoch_acc0.5608197755645961 _val_iou0.4737466574196785
epoch1.0  _train_loss0.048448000103235245  _val_loss0.10944708585739135 _epoch_acc0.8001865204423666 _val_iou0.5133201433666483
epoch2.0  _train_loss0.03926097974181175  _val_loss0.08787520229816437 _epoch_acc0.825930627528578 _val_iou0.7985184229910374
epoch3.0  _train_loss0.038626120115319885  _val_loss0.07455807328224182 _epoch_acc0.8141983523964882 _val_iou0.7413750952109694
epoch4.0  _train_loss0.04134070438643297  _val_loss0.07070631980895996 _epoch_acc0.7849969458184205 _val_iou0.686036984436214

['lr', '0.0001']
['batch', 8]
['seed', 8]
['best_val_acc', '0.7985184229910374'] #notevole
['warm_epoch', 0]
['end_epoch', 5]

#---------------------------------------------------------------------------------------------------------------------------------------------

efficientnet-b0

==============================================================================================================
Layer (type:depth-idx)                                       Output Shape              Param #
==============================================================================================================
SwinUnet                                                     [16, 2, 512, 512]         --
├─SwinTransformerSys: 1-1                                    [16, 2, 512, 512]         7,286,240
│    └─EfficientNetEncoder: 2-1                              [16, 3, 512, 512]         412,160
│    │    └─Conv2dStaticSamePadding: 3-1                     [16, 32, 256, 256]        864
│    │    └─BatchNorm2d: 3-2                                 [16, 32, 256, 256]        64
│    │    └─MemoryEfficientSwish: 3-3                        [16, 32, 256, 256]        --
│    │    └─ModuleList: 3-4                                  --                        3,594,460
│    └─PatchEmbed: 2-2                                       [16, 16384, 96]           --
│    │    └─Conv2d: 3-5                                      [16, 96, 128, 128]        4,704
│    │    └─LayerNorm: 3-6                                   [16, 16384, 96]           192
│    └─Dropout: 2-3                                          [16, 16384, 96]           --
│    └─ModuleList: 2-4                                       --                        --
│    │    └─BasicLayer: 3-7                                  [16, 4096, 192]           303,942
│    │    └─BasicLayer: 3-8                                  [16, 1024, 384]           1,197,708
│    │    └─BasicLayer: 3-9                                  [16, 256, 768]            4,754,712
│    │    └─BasicLayer: 3-10                                 [16, 256, 768]            14,221,872
│    └─LayerNorm: 2-5                                        [16, 256, 768]            1,536
│    └─ModuleList: 2-6                                       --                        --
│    │    └─SCF_block: 3-11                                  [16, 256, 16, 16]         6,382,234
│    │    └─SCF_block: 3-12                                  [16, 128, 32, 32]         1,581,579
│    │    └─SCF_block: 3-13                                  [16, 64, 64, 64]          394,168
│    │    └─SCF_block: 3-14                                  [16, 32, 128, 128]        99,763
│    └─UnetDecoder: 2-7                                      [16, 32, 256, 256]        --
│    │    └─ModuleList: 3-15                                 --                        2,149,248
│    └─SegmentationHead: 2-8                                 [16, 2, 512, 512]         --
│    │    └─Conv2d: 3-16                                     [16, 2, 256, 256]         578
│    │    └─UpsamplingBilinear2d: 3-17                       [16, 2, 512, 512]         --
│    │    └─Activation: 3-18                                 [16, 2, 512, 512]         --
==============================================================================================================
Total params: 42,386,024
Trainable params: 42,386,024
Non-trainable params: 0
Total mult-adds (G): 148.08
==============================================================================================================
Input size (MB): 50.33
Forward/backward pass size (MB): 17635.74
Params size (MB): 99.09
Estimated Total Size (MB): 17785.16
==============================================================================================================

epoch0.0  _train_loss0.09024086594581604  _val_loss0.1449487626552582 _epoch_acc0.3386331719812006 _val_iou0.03208982533033122
epoch1.0  _train_loss0.06189078837633133  _val_loss0.146824848651886 _epoch_acc0.6507034515962005 _val_iou0.20622418192215264
epoch2.0  _train_loss0.051767803728580475  _val_loss0.12096807956695557 _epoch_acc0.7656137173374494 _val_iou0.5886242603883147
epoch3.0  _train_loss0.04491790197789669  _val_loss0.10290662944316864 _epoch_acc0.8161119745733837 _val_iou0.6547506214119494
epoch4.0  _train_loss0.04578971800704797  _val_loss0.09512539207935333 _epoch_acc0.7882906376194873 _val_iou0.6640832559205592

['lr', '0.0001']
['batch', 8]
['seed', 8]
['best_val_acc', '0.6640832559205592']
['warm_epoch', 0]
['end_epoch', 5]

#---------------------------------------------------------------------------------------------------------------------------------------------

efficientnet-b4

==============================================================================================================
Layer (type:depth-idx)                                       Output Shape              Param #
==============================================================================================================
SwinUnet                                                     [16, 2, 512, 512]         --
├─SwinTransformerSys: 1-1                                    [16, 2, 512, 512]         7,326,432
│    └─EfficientNetEncoder: 2-1                              [16, 3, 512, 512]         806,400
│    │    └─Conv2dStaticSamePadding: 3-1                     [16, 48, 256, 256]        1,296
│    │    └─BatchNorm2d: 3-2                                 [16, 48, 256, 256]        96
│    │    └─MemoryEfficientSwish: 3-3                        [16, 48, 256, 256]        --
│    │    └─ModuleList: 3-4                                  --                        16,740,824
│    └─PatchEmbed: 2-2                                       [16, 16384, 96]           --
│    │    └─Conv2d: 3-5                                      [16, 96, 128, 128]        4,704
│    │    └─LayerNorm: 3-6                                   [16, 16384, 96]           192
│    └─Dropout: 2-3                                          [16, 16384, 96]           --
│    └─ModuleList: 2-4                                       --                        --
│    │    └─BasicLayer: 3-7                                  [16, 4096, 192]           303,942
│    │    └─BasicLayer: 3-8                                  [16, 1024, 384]           1,197,708
│    │    └─BasicLayer: 3-9                                  [16, 256, 768]            4,754,712
│    │    └─BasicLayer: 3-10                                 [16, 256, 768]            14,221,872
│    └─LayerNorm: 2-5                                        [16, 256, 768]            1,536
│    └─ModuleList: 2-6                                       --                        --
│    │    └─SCF_block: 3-11                                  [16, 256, 16, 16]         6,476,978
│    │    └─SCF_block: 3-12                                  [16, 128, 32, 32]         1,598,772
│    │    └─SCF_block: 3-13                                  [16, 64, 64, 64]          396,971
│    │    └─SCF_block: 3-14                                  [16, 32, 128, 128]        100,518
│    └─UnetDecoder: 2-7                                      [16, 32, 256, 256]        --
│    │    └─ModuleList: 3-15                                 --                        2,149,248
│    └─SegmentationHead: 2-8                                 [16, 2, 512, 512]         --
│    │    └─Conv2d: 3-16                                     [16, 2, 256, 256]         578
│    │    └─UpsamplingBilinear2d: 3-17                       [16, 2, 512, 512]         --
│    │    └─Activation: 3-18                                 [16, 2, 512, 512]         --
==============================================================================================================
Total params: 56,082,779
Trainable params: 56,082,779
Non-trainable params: 0
Total mult-adds (G): 149.02
==============================================================================================================
Input size (MB): 50.33
Forward/backward pass size (MB): 24528.09
Params size (MB): 99.88
Estimated Total Size (MB): 24678.30
==============================================================================================================

epoch0.0  _train_loss0.0743353081246217  _val_loss0.1321811258792877 _epoch_acc0.544605623697862 _val_iou0.6933611431159079
epoch1.0  _train_loss0.0553085058927536  _val_loss0.12440397143363953 _epoch_acc0.7742816779452065 _val_iou0.6678159274160862
epoch2.0  _train_loss0.04733793002863725  _val_loss0.10978846549987793 _epoch_acc0.8196983318775892 _val_iou0.7019209526479244
epoch3.0  _train_loss0.043290361762046814  _val_loss0.09982194900512695 _epoch_acc0.8253462806654474 _val_iou0.6848060879856348
epoch4.0  _train_loss0.04508913060029348  _val_loss0.09350438416004181 _epoch_acc0.7902477253228426 _val_iou0.6768605755642056

['lr', '0.0001']
['batch', 8]
['seed', 8]
['best_val_acc', '0.7019209526479244']
['warm_epoch', 0]
['end_epoch', 5]

#------------------------------------------------------------------------------------------------------------------------------------------------------

501 training images



timm-mobilenetv3_small_minimal_100

==============================================================================================================
Layer (type:depth-idx)                                       Output Shape              Param #
==============================================================================================================
SwinUnet                                                     [16, 2, 512, 512]         --
├─SwinTransformerSys: 1-1                                    [16, 2, 512, 512]         7,342,304
│    └─MobileNetV3Encoder: 2-1                               [16, 3, 512, 512]         --
│    │    └─MobileNetV3Features: 3-1                         --                        428,888
│    └─PatchEmbed: 2-2                                       [16, 16384, 96]           --
│    │    └─Conv2d: 3-2                                      [16, 96, 128, 128]        4,704
│    │    └─LayerNorm: 3-3                                   [16, 16384, 96]           192
│    └─Dropout: 2-3                                          [16, 16384, 96]           --
│    └─ModuleList: 2-4                                       --                        --
│    │    └─BasicLayer: 3-4                                  [16, 4096, 192]           303,942
│    │    └─BasicLayer: 3-5                                  [16, 1024, 384]           1,197,708
│    │    └─BasicLayer: 3-6                                  [16, 256, 768]            4,754,712
│    │    └─BasicLayer: 3-7                                  [16, 256, 768]            14,221,872
│    └─LayerNorm: 2-5                                        [16, 256, 768]            1,536
│    └─ModuleList: 2-6                                       --                        --
│    │    └─SCF_block: 3-8                                   [16, 256, 16, 16]         6,575,818
│    │    └─SCF_block: 3-9                                   [16, 128, 32, 32]         1,559,551
│    │    └─SCF_block: 3-10                                  [16, 64, 64, 64]          391,429
│    │    └─SCF_block: 3-11                                  [16, 32, 128, 128]        99,075
│    └─UnetDecoder: 2-7                                      [16, 32, 256, 256]        --
│    │    └─ModuleList: 3-12                                 --                        2,149,248
│    └─SegmentationHead: 2-8                                 [16, 2, 512, 512]         --
│    │    └─Conv2d: 3-13                                     [16, 2, 256, 256]         578
│    │    └─UpsamplingBilinear2d: 3-14                       [16, 2, 512, 512]         --
│    │    └─Activation: 3-15                                 [16, 2, 512, 512]         --
==============================================================================================================
Total params: 39,031,557
Trainable params: 39,031,557
Non-trainable params: 0
Total mult-adds (G): 152.31
==============================================================================================================
Input size (MB): 50.33
Forward/backward pass size (MB): 15036.37
Params size (MB): 101.32
Estimated Total Size (MB): 15188.02
==============================================================================================================

['lr', '0.0001']
['batch', 8]
['seed', 8]
['best_val_acc', '0.7314308832577567']
['warm_epoch', 0]
['end_epoch', 5]


epoch0.0  _train_loss0.04727929885740633  _val_loss0.03606458706781268 _epoch_acc0.7294590153638274 _val_iou0.6767781655947768
epoch1.0  _train_loss0.02953611148728265  _val_loss0.03603513864800334 _epoch_acc0.8127967626834288 _val_iou0.6790149949378006
epoch2.0  _train_loss0.027426713557890905  _val_loss0.02517904795240611 _epoch_acc0.8190846052219233 _val_iou0.7259127953733455
epoch3.0  _train_loss0.023205948501457404  _val_loss0.0265552569180727 _epoch_acc0.8457568175998017 _val_iou0.7314308832577567
epoch4.0  _train_loss0.021809269579840296  _val_loss0.031395346857607365 _epoch_acc0.8544014574820176 _val_iou0.7047500769989155

#------------------------------------------------------------------------------------------------------------------------------------------------------

501 training images



efficientnet-b4


==============================================================================================================
Layer (type:depth-idx)                                       Output Shape              Param #
==============================================================================================================
SwinUnet                                                     [16, 2, 512, 512]         --
├─SwinTransformerSys: 1-1                                    [16, 2, 512, 512]         7,326,432
│    └─EfficientNetEncoder: 2-1                              [16, 3, 512, 512]         806,400
│    │    └─Conv2dStaticSamePadding: 3-1                     [16, 48, 256, 256]        1,296
│    │    └─BatchNorm2d: 3-2                                 [16, 48, 256, 256]        96
│    │    └─MemoryEfficientSwish: 3-3                        [16, 48, 256, 256]        --
│    │    └─ModuleList: 3-4                                  --                        16,740,824
│    └─PatchEmbed: 2-2                                       [16, 16384, 96]           --
│    │    └─Conv2d: 3-5                                      [16, 96, 128, 128]        4,704
│    │    └─LayerNorm: 3-6                                   [16, 16384, 96]           192
│    └─Dropout: 2-3                                          [16, 16384, 96]           --
│    └─ModuleList: 2-4                                       --                        --
│    │    └─BasicLayer: 3-7                                  [16, 4096, 192]           303,942
│    │    └─BasicLayer: 3-8                                  [16, 1024, 384]           1,197,708
│    │    └─BasicLayer: 3-9                                  [16, 256, 768]            4,754,712
│    │    └─BasicLayer: 3-10                                 [16, 256, 768]            14,221,872
│    └─LayerNorm: 2-5                                        [16, 256, 768]            1,536
│    └─ModuleList: 2-6                                       --                        --
│    │    └─SCF_block: 3-11                                  [16, 256, 16, 16]         6,476,978
│    │    └─SCF_block: 3-12                                  [16, 128, 32, 32]         1,598,772
│    │    └─SCF_block: 3-13                                  [16, 64, 64, 64]          396,971
│    │    └─SCF_block: 3-14                                  [16, 32, 128, 128]        100,518
│    └─UnetDecoder: 2-7                                      [16, 32, 256, 256]        --
│    │    └─ModuleList: 3-15                                 --                        2,149,248
│    └─SegmentationHead: 2-8                                 [16, 2, 512, 512]         --
│    │    └─Conv2d: 3-16                                     [16, 2, 256, 256]         578
│    │    └─UpsamplingBilinear2d: 3-17                       [16, 2, 512, 512]         --
│    │    └─Activation: 3-18                                 [16, 2, 512, 512]         --
==============================================================================================================
Total params: 56,082,779
Trainable params: 56,082,779
Non-trainable params: 0
Total mult-adds (G): 149.02
==============================================================================================================
Input size (MB): 50.33
Forward/backward pass size (MB): 24528.09
Params size (MB): 99.88
Estimated Total Size (MB): 24678.30
==============================================================================================================

['lr', '0.0001']
['batch', 8]
['seed', 8]
['best_val_acc', '0.7863273760594893']
['warm_epoch', 0]
['end_epoch', 5]


epoch0.0  _train_loss0.04043353531095717  _val_loss0.02462664304766804 _epoch_acc0.7638367187092081 _val_iou0.7378778246060151
epoch1.0  _train_loss0.026179388570196836  _val_loss0.018712433520704508 _epoch_acc0.8377195214154198 _val_iou0.7651156423526118
epoch2.0  _train_loss0.020385332258395207  _val_loss0.019275436643511057 _epoch_acc0.8623761142976583 _val_iou0.7487187243540174
epoch3.0  _train_loss0.019097889923019175  _val_loss0.017959245247766376 _epoch_acc0.8648223369847983 _val_iou0.7863273760594893
epoch4.0  _train_loss0.019366531754717416  _val_loss0.016739518498070538 _epoch_acc0.8640858909122824 _val_iou0.7805811538710259


#------------------------------------------------------------------------------------------------------------------------------------------------------

501 training images


efficientnet-b0	(original)

==============================================================================================================
Layer (type:depth-idx)                                       Output Shape              Param #
==============================================================================================================
SwinUnet                                                     [16, 2, 512, 512]         --
├─SwinTransformerSys: 1-1                                    [16, 2, 512, 512]         7,286,240
│    └─EfficientNetEncoder: 2-1                              [16, 3, 512, 512]         412,160
│    │    └─Conv2dStaticSamePadding: 3-1                     [16, 32, 256, 256]        864
│    │    └─BatchNorm2d: 3-2                                 [16, 32, 256, 256]        64
│    │    └─MemoryEfficientSwish: 3-3                        [16, 32, 256, 256]        --
│    │    └─ModuleList: 3-4                                  --                        3,594,460
│    └─PatchEmbed: 2-2                                       [16, 16384, 96]           --
│    │    └─Conv2d: 3-5                                      [16, 96, 128, 128]        4,704
│    │    └─LayerNorm: 3-6                                   [16, 16384, 96]           192
│    └─Dropout: 2-3                                          [16, 16384, 96]           --
│    └─ModuleList: 2-4                                       --                        --
│    │    └─BasicLayer: 3-7                                  [16, 4096, 192]           303,942
│    │    └─BasicLayer: 3-8                                  [16, 1024, 384]           1,197,708
│    │    └─BasicLayer: 3-9                                  [16, 256, 768]            4,754,712
│    │    └─BasicLayer: 3-10                                 [16, 256, 768]            14,221,872
│    └─LayerNorm: 2-5                                        [16, 256, 768]            1,536
│    └─ModuleList: 2-6                                       --                        --
│    │    └─SCF_block: 3-11                                  [16, 256, 16, 16]         6,382,234
│    │    └─SCF_block: 3-12                                  [16, 128, 32, 32]         1,581,579
│    │    └─SCF_block: 3-13                                  [16, 64, 64, 64]          394,168
│    │    └─SCF_block: 3-14                                  [16, 32, 128, 128]        99,763
│    └─UnetDecoder: 2-7                                      [16, 32, 256, 256]        --
│    │    └─ModuleList: 3-15                                 --                        2,149,248
│    └─SegmentationHead: 2-8                                 [16, 2, 512, 512]         --
│    │    └─Conv2d: 3-16                                     [16, 2, 256, 256]         578
│    │    └─UpsamplingBilinear2d: 3-17                       [16, 2, 512, 512]         --
│    │    └─Activation: 3-18                                 [16, 2, 512, 512]         --
==============================================================================================================
Total params: 42,386,024
Trainable params: 42,386,024
Non-trainable params: 0
Total mult-adds (G): 148.08
==============================================================================================================
Input size (MB): 50.33
Forward/backward pass size (MB): 17635.74
Params size (MB): 99.09
Estimated Total Size (MB): 17785.16
==============================================================================================================

['lr', '0.0001']
['batch', 8]
['seed', 8]
['best_val_acc', '0.7446124435231227']
['warm_epoch', 0]
['end_epoch', 5]


epoch0.0  _train_loss0.050450844455648354  _val_loss0.031395114492625 _epoch_acc0.7124779606924858 _val_iou0.7184789919410832
epoch1.0  _train_loss0.029561658810686182  _val_loss0.030438603600487113 _epoch_acc0.819011174608022 _val_iou0.7103615173258491
epoch2.0  _train_loss0.025914641478915274  _val_loss0.024640812422148883 _epoch_acc0.8330648985877633 _val_iou0.7307188929993326
epoch3.0  _train_loss0.02304436492699164  _val_loss0.023551577352918684 _epoch_acc0.8481148437247874 _val_iou0.7437862360969789
epoch4.0  _train_loss0.023028529223836497  _val_loss0.023097912780940533 _epoch_acc0.8506132898665965 _val_iou0.7446124435231227

#------------------------------------------------------------------------------------------------------------------------------------------------------



501

resnet 50

['lr', '0.0001']
['batch', 8]
['seed', 8]
['best_val_acc', '0.7557969187814769']
['warm_epoch', 0]
['end_epoch', 5]


epoch0.0  _train_loss0.04931319863707931  _val_loss0.038385970052331686 _epoch_acc0.7275460836617745 _val_iou0.7124638584799046
epoch1.0  _train_loss0.030381177788899268  _val_loss0.038628136506304145 _epoch_acc0.8249130337685346 _val_iou0.6717260144435184
epoch2.0  _train_loss0.02553753231042697  _val_loss0.02381705364678055 _epoch_acc0.8454715672381493 _val_iou0.7557969187814769
epoch3.0  _train_loss0.023805342265117317  _val_loss0.027125429594889283 _epoch_acc0.8490786626446061 _val_iou0.7503024676866517
epoch4.0  _train_loss0.021068327496817082  _val_loss0.02711931336671114 _epoch_acc0.8656527359783649 _val_iou0.7434888149582548
